# REST-сервис для просмотра зарплаты и даты следующего повышения
Это репозиторий содержит реализацию REST-сервиса, который позволяет просматривать текущую зарплату и дату следующего повышения для каждого
#
### Технологии
Сервис реализован с использованием асинхронного подключения к базе данных при помощи SQLAlchemy и Asyncpg. Также используется асинхронный pytest для написания тестов. Регистрация и авторизация реализованна при помощи библиотеки [`fastapi_users`](https://fastapi-users.github.io/fastapi-users/12.0/).
#
### Установка и Запуск
1. Склонируйте репозиторий:
    ```sh
    git clone git@gitlab.com:nnnLik/shift-ml-testtask.git
    ```
2. Перейдите в каталог проекта:
    ```sh
    cd shift-ml-testtask
    ```
3. Запустите сервис и базу данных в Docker с помощью Docker Compose:
    ```sh
    docker-compose up --build
    ```
4. После успешного запуска, сервис будет доступен по адресу:
    ```
    http://localhost:8888
    ```
#
### Документация API
Документация по API сервиса доступна по адресу:
```
http://localhost:8888/docs
```
#
##### __Регистрация пользователя__
Для получения доступа к информации о зарплате и дате следующего повышения необходимо зарегистрировать пользователя. Отправьте `POST`-запрос на эндпоинт `/auth/jwt/register` со следующими данными в теле запроса:
```json
{
  "email": "example@example.com",
  "password": "secret",
  "is_active": true,
  "is_superuser": false,
  "is_verified": false
}
```

##### __Заполнение данных пользователя__
После успешной регистрации, заполните информацию о пользователе отправив `POST`-запрос на эндпоинт `/employee/info`. Передайте следующие данные в теле запроса:
```json
{
  "first_name": "Big",
  "last_name": "Dude",
  "birth_year": 1900,
  "position_id": 1
}
```

##### __Создать должность__
Для создания должности отправьте `POST`-запрос на эндпоинт `/position/positions`. Передайте следующие данные в теле запроса:
```json
{
  "id": 1,
  "name": "Front End Developer",
  "base_salary": 600
}
```

##### __Получение информации о зарплате__
Для получения информации о зарплате и дате следующего повышения отправьте `GET`-запрос на эндпоинт `/employee/salary`. В заголовке запроса укажите авторизационный токен:
```
Authorization: Bearer <token>
```

В ответ вы получите следующее:
```json
{
  "id": int,
  "first_name": str,
  "last_name": str,
  "birth_year": int,
  "employment_date": str,
  "position": str,
  "employee_id": str,
  "salary": int,
  "next_increase_date": str,
  "days_until_increase": int
}
```
#
### Тесты
1. Для запуска теста надо будет установить все зависимости:
    ```sh
    poetry install
    ```
2. Запуск Тестов:
    ```sh
    pytest -vv tests/
    ```
1. 
